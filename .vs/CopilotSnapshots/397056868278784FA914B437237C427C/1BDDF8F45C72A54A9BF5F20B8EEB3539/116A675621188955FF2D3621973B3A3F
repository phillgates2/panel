# Panel Configuration Example
# Copy this file to config.py and customize for your environment

import os

# =============================================================================
# SECURITY SETTINGS
# =============================================================================

# Secret key for session encryption (CHANGE THIS IN PRODUCTION!)
SECRET_KEY = os.environ.get('PANEL_SECRET_KEY', 'dev-secret-key-change-in-production')

# Session security
SESSION_COOKIE_SECURE = os.environ.get('PANEL_SESSION_SECURE', 'False').lower() == 'true'
SESSION_COOKIE_HTTPONLY = True
SESSION_COOKIE_SAMESITE = 'Lax'

# Password security
BCRYPT_ROUNDS = 12

# =============================================================================
# DATABASE SETTINGS
# =============================================================================

# SQLite (development)
SQLALCHEMY_DATABASE_URI = os.environ.get('PANEL_SQLITE_URI', 'sqlite:///panel_dev.db')

# PostgreSQL (production) - uncomment and configure
# SQLALCHEMY_DATABASE_URI = os.environ.get('DATABASE_URL', 'postgresql://user:password@localhost/panel')

# Database connection pool
SQLALCHEMY_POOL_SIZE = int(os.environ.get('PANEL_DB_POOL_SIZE', '10'))
SQLALCHEMY_MAX_OVERFLOW = int(os.environ.get('PANEL_DB_MAX_OVERFLOW', '20'))
SQLALCHEMY_POOL_TIMEOUT = 30
SQLALCHEMY_POOL_RECYCLE = 3600
SQLALCHEMY_POOL_PRE_PING = True

# =============================================================================
# CACHE & SESSION SETTINGS
# =============================================================================

# Redis configuration
REDIS_URL = os.environ.get('PANEL_REDIS_URL', 'redis://127.0.0.1:6379/0')

# Flask-Caching
CACHE_TYPE = os.environ.get('PANEL_CACHE_TYPE', 'redis')
CACHE_REDIS_URL = REDIS_URL
CACHE_DEFAULT_TIMEOUT = int(os.environ.get('PANEL_CACHE_TIMEOUT', '300'))

# =============================================================================
# RATE LIMITING
# =============================================================================

# Rate limiting configuration
RATELIMIT_STORAGE_URL = REDIS_URL
RATELIMIT_DEFAULT = os.environ.get('PANEL_RATE_LIMIT', '200 per hour')
RATELIMIT_STRATEGY = 'fixed-window'

# Advanced rate limiting
RATE_LIMIT_ABUSE_THRESHOLD = float(os.environ.get('PANEL_ABUSE_THRESHOLD', '10.0'))  # requests per minute
RATE_LIMIT_BLOCK_DURATION = int(os.environ.get('PANEL_BLOCK_DURATION', '3600'))  # seconds

# Cloudflare integration
CLOUDFLARE_API_TOKEN = os.environ.get('CLOUDFLARE_API_TOKEN')
CLOUDFLARE_ZONE_ID = os.environ.get('CLOUDFLARE_ZONE_ID')

# =============================================================================
# FILE UPLOAD SETTINGS
# =============================================================================

UPLOAD_FOLDER = os.environ.get('PANEL_UPLOAD_FOLDER', 'static/uploads')
MAX_CONTENT_LENGTH = int(os.environ.get('PANEL_MAX_CONTENT_LENGTH', str(16 * 1024 * 1024)))  # 16MB

# Allowed file extensions
ALLOWED_EXTENSIONS = {'png', 'jpg', 'jpeg', 'gif', 'webp', 'svg'}

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

LOG_LEVEL = os.environ.get('PANEL_LOG_LEVEL', 'INFO')
LOG_DIR = os.environ.get('PANEL_LOG_DIR', 'instance/logs')
LOG_MAX_BYTES = int(os.environ.get('PANEL_LOG_MAX_BYTES', str(10 * 1024 * 1024)))  # 10MB
LOG_BACKUP_COUNT = int(os.environ.get('PANEL_LOG_BACKUP_COUNT', '5'))

# =============================================================================
# EMAIL SETTINGS
# =============================================================================

MAIL_SERVER = os.environ.get('PANEL_MAIL_SERVER', 'localhost')
MAIL_PORT = int(os.environ.get('PANEL_MAIL_PORT', '587'))
MAIL_USE_TLS = os.environ.get('PANEL_MAIL_TLS', 'True').lower() == 'true'
MAIL_USE_SSL = os.environ.get('PANEL_MAIL_SSL', 'False').lower() == 'true'
MAIL_USERNAME = os.environ.get('PANEL_MAIL_USERNAME')
MAIL_PASSWORD = os.environ.get('PANEL_MAIL_PASSWORD')
MAIL_DEFAULT_SENDER = os.environ.get('PANEL_MAIL_SENDER', 'noreply@panel.local')

# =============================================================================
# EXTERNAL SERVICE INTEGRATIONS
# =============================================================================

# Discord webhooks
DISCORD_WEBHOOK_URL = os.environ.get('PANEL_DISCORD_WEBHOOK')

# Slack webhooks
SLACK_WEBHOOK_URL = os.environ.get('PANEL_SLACK_WEBHOOK')

# Admin notifications
ADMIN_EMAILS = os.environ.get('PANEL_ADMIN_EMAILS', '').split(',') if os.environ.get('PANEL_ADMIN_EMAILS') else []

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Theme system
THEME_ENABLED = os.environ.get('PANEL_THEME_ENABLED', 'True').lower() == 'true'
THEME_FORCED = os.environ.get('PANEL_THEME_FORCED')  # 'light' or 'dark'

# CAPTCHA
CAPTCHA_ENABLED = os.environ.get('PANEL_CAPTCHA_ENABLED', 'False').lower() == 'true'

# API features
API_ENABLED = os.environ.get('PANEL_API_ENABLED', 'True').lower() == 'true'
API_RATE_LIMIT = os.environ.get('PANEL_API_RATE_LIMIT', '100 per hour')

# Forum features
FORUM_ENABLED = os.environ.get('PANEL_FORUM_ENABLED', 'True').lower() == 'true'
FORUM_PER_PAGE = int(os.environ.get('PANEL_FORUM_PER_PAGE', '10'))
FORUM_REPLIES_PER_PAGE = int(os.environ.get('PANEL_FORUM_REPLIES_PER_PAGE', '20'))

# CMS features
CMS_ENABLED = os.environ.get('PANEL_CMS_ENABLED', 'True').lower() == 'true'
CMS_PER_PAGE = int(os.environ.get('PANEL_CMS_PER_PAGE', '10'))

# Server management
SERVER_MANAGEMENT_ENABLED = os.environ.get('PANEL_SERVER_MGMT_ENABLED', 'True').lower() == 'true'

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================

DEBUG = os.environ.get('FLASK_DEBUG', 'False').lower() == 'true'
TESTING = os.environ.get('FLASK_TESTING', 'False').lower() == 'true'

# Development overrides
if DEBUG:
    # Less strict rate limiting in development
    RATELIMIT_DEFAULT = '1000 per hour'
    CAPTCHA_ENABLED = False
    SESSION_COOKIE_SECURE = False

# =============================================================================
# ADMIN SETTINGS (DEVELOPMENT ONLY)
# =============================================================================

# Legacy admin authentication (for development)
ADMIN_USER = os.environ.get('PANEL_ADMIN_USER', 'admin')
ADMIN_PASSWORD = os.environ.get('PANEL_ADMIN_PASSWORD', 'admin')

# =============================================================================
# GAME SERVER SETTINGS
# =============================================================================

# ET:Legacy server defaults
ET_SERVER_HOST = os.environ.get('PANEL_ET_HOST', '127.0.0.1')
ET_SERVER_PORT = int(os.environ.get('PANEL_ET_PORT', '27960'))
ET_RCON_PASSWORD = os.environ.get('PANEL_ET_RCON_PASSWORD', 'changeme')

# Server templates
DEFAULT_GAME_TYPE = os.environ.get('PANEL_DEFAULT_GAME_TYPE', 'etlegacy')

# =============================================================================
# BACKUP SETTINGS
# =============================================================================

BACKUP_ENABLED = os.environ.get('PANEL_BACKUP_ENABLED', 'True').lower() == 'true'
BACKUP_DIR = os.environ.get('PANEL_BACKUP_DIR', 'backups')
BACKUP_RETENTION_DAYS = int(os.environ.get('PANEL_BACKUP_RETENTION', '30'))

# S3 backup settings
S3_BACKUP_ENABLED = os.environ.get('PANEL_S3_BACKUP_ENABLED', 'False').lower() == 'true'
S3_BUCKET = os.environ.get('PANEL_S3_BUCKET')
S3_REGION = os.environ.get('PANEL_S3_REGION', 'us-east-1')
S3_ACCESS_KEY = os.environ.get('PANEL_S3_ACCESS_KEY')
S3_SECRET_KEY = os.environ.get('PANEL_S3_SECRET_KEY')

# =============================================================================
# MONITORING & METRICS
# =============================================================================

METRICS_ENABLED = os.environ.get('PANEL_METRICS_ENABLED', 'True').lower() == 'true'
HEALTH_CHECK_ENABLED = os.environ.get('PANEL_HEALTH_ENABLED', 'True').lower() == 'true'

# Performance thresholds
PERFORMANCE_THRESHOLD_MS = int(os.environ.get('PANEL_PERF_THRESHOLD', '500'))

# =============================================================================
# THIRD-PARTY INTEGRATIONS
# =============================================================================

# Analytics
GOOGLE_ANALYTICS_ID = os.environ.get('PANEL_GA_ID')

# OAuth 2.0 Social Login
GOOGLE_CLIENT_ID = os.environ.get('GOOGLE_CLIENT_ID')
GOOGLE_CLIENT_SECRET = os.environ.get('GOOGLE_CLIENT_SECRET')

GITHUB_CLIENT_ID = os.environ.get('GITHUB_CLIENT_ID')
GITHUB_CLIENT_SECRET = os.environ.get('GITHUB_CLIENT_SECRET')

DISCORD_CLIENT_ID = os.environ.get('DISCORD_CLIENT_ID')
DISCORD_CLIENT_SECRET = os.environ.get('DISCORD_CLIENT_SECRET')

# OAuth settings
OAUTH_ENABLED = os.environ.get('OAUTH_ENABLED', 'True').lower() == 'true'

# =============================================================================
# GDPR COMPLIANCE
# =============================================================================

GDPR_ENABLED = os.environ.get('GDPR_ENABLED', 'True').lower() == 'true'
GDPR_RETENTION_AUDIT_LOGS = int(os.environ.get('GDPR_RETENTION_AUDIT', '2555'))  # days (7 years)
GDPR_RETENTION_ACTIVITIES = int(os.environ.get('GDPR_RETENTION_ACTIVITIES', '365'))  # days (1 year)
GDPR_RETENTION_TEMP_FILES = int(os.environ.get('GDPR_RETENTION_TEMP', '30'))  # days

# Progressive Web App (PWA)
PWA_ENABLED = os.environ.get('PWA_ENABLED', 'True').lower() == 'true'
PWA_CACHE_NAME = 'panel-v1.0.0'
PWA_OFFLINE_PAGE = '/offline'

# Push Notifications (VAPID keys for Web Push)
VAPID_PUBLIC_KEY = os.environ.get('VAPID_PUBLIC_KEY')
VAPID_PRIVATE_KEY = os.environ.get('VAPID_PRIVATE_KEY')
VAPID_SUBJECT = os.environ.get('VAPID_SUBJECT', 'mailto:admin@panel.local')

# Real-time Features (WebSockets)
REALTIME_ENABLED = os.environ.get('REALTIME_ENABLED', 'True').lower() == 'true'
SOCKETIO_CORS_ALLOWED_ORIGINS = os.environ.get('SOCKETIO_CORS_ORIGINS', '*')
SOCKETIO_ASYNC_MODE = 'threading'  # or 'eventlet' for better performance